package com.jpro.studentsmeetbackend.testcase;

import static org.junit.Assert.*;

import org.junit.BeforeClass;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import com.jpro.studentsmeetbackend.dao.ChatDAO;
import com.jpro.studentsmeetbackend.model.Chat;
import com.jpro.studentsmeetbackend.model.ChatMessage;

import junit.framework.Assert;

public class ChatDAOTestCase {
	
	@Autowired
	static Chat chat;
	
	@Autowired
	static ChatDAO chatDAO;
	
	@Autowired
	static AnnotationConfigApplicationContext context;

	@BeforeClass
	public static  void init()
	{
		context = new AnnotationConfigApplicationContext();
		context.scan("com.jpro.studentsmeetbackend");
		context.refresh();
		chat = (Chat) context.getBean("chat");
		chatDAO = (ChatDAO) context.getBean("chatDAO");
	}
	
	@Test
	public void createChatTestCase(){
		chat.setIsPrivateChat('N');
		chat.setReportChat('N');
		boolean flag=chatDAO.createChat(chat);
		Assert.assertEquals("createChatTestCases", true, flag);
	}
	
	@Test
	public void removeChatandGetChatByIDTestCase(){
		chat=chatDAO.getChatById(1);
		boolean flag=chatDAO.removeChat(chat);
		Assert.assertEquals("createChatTestCases", true, flag);
	}
	
	@Test
	public void addChatMessage(){
		ChatMessage msg=new ChatMessage();
		msg.setChatID(1);
		msg.setChatMsg("Hello");
		msg.setUserID("US001");
		boolean flag=chatDAO.addChatMessage(msg.getChatID(), msg);
		Assert.assertEquals("createChatTestCases", true, flag);
	}
	
	@Test
	public void getAllChatTestCase(){
		int flag=chatDAO.getAllChat().size();
		Assert.assertEquals("createChatTestCases", 1, flag);
	}
	
	@Test
	public void getALLChatMessageTestCase(){
		int flag=chatDAO.getAllChatMessage(1).size();
		Assert.assertEquals("createChatTestCases", 1, flag);
	}

}
